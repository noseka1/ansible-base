- name: Obtain all storage class objects
  kubernetes.core.k8s_info:
    api_version: storage.k8s.io/v1
    kind: StorageClass
  register: oscommon_storage_classes_result

- set_fact:
    oscommon_default_storage_class: ''
    oscommon_default_storage_class_exists: false

- set_fact:
    oscommon_default_storage_class: '{{ item.metadata.name }}'
    oscommon_default_storage_class_exists: true
  when:
    - item.metadata.annotations['storageclass.kubernetes.io/is-default-class'] | default('') == 'true'
  loop: '{{ oscommon_storage_classes_result.resources }}'
  loop_control:
    label: '{{ item.metadata.name }}'
