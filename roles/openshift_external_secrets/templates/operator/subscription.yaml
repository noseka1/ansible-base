apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: openshift-external-secrets-operator
  namespace: external-secrets-operator
spec:
  channel: {{ extsecrets_operator_subscription_channel | default('""', true) }}
  installPlanApproval: Manual
  name: openshift-external-secrets-operator
  source: redhat-operators
  sourceNamespace: openshift-marketplace
  startingCSV: {{ extsecrets_operator_subscription_starting_csv | default('""', true) }}
  config:
    env:
      # Operator log level, values range from 1-5, the default is 2
      - name: OPERATOR_LOG_LEVEL
        value: '2'
{% if extsecrets_place_on_infra_nodes %}
    nodeSelector:
      node-role.kubernetes.io/infra: ""
    tolerations:
    - key: node-role.kubernetes.io/infra
      effect: NoSchedule
      operator: Exists
{% endif %}
