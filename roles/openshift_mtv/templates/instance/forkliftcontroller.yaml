apiVersion: forklift.konveyor.io/v1beta1
kind: ForkliftController
metadata:
  name: forklift-controller
  namespace: openshift-mtv
# Available settings can be found at:
# https://github.com/kubev2v/forklift/blob/8cab1f558b89346d1eefaa2d8947404d884f8dd3/operator/config/crd/bases/forklift.konveyor.io_forkliftcontrollers.yaml
spec:
  # Improve MTV performance by tuning the following settings:
  controller_container_limits_cpu: "8"
  controller_container_limits_memory: 8Gi
  controller_max_concurrent_reconciles: 20
  inventory_container_limits_cpu: "4"
  inventory_container_limits_memory: 8Gi
  # The following table describes the optimal MAX_VM_INFLIGHT values for vSphere versions and endpoints:
  # vSphere version	   Endpoint            Optimal MAX_VM_INFLIGHT value
  # 6.5                ESXi endpoint       10
  # 6.7                ESXi endpoint       40
  # 6.7                vSphere endpoint    50
  #
  # See also:
  # Performance recommendations for migrating from VMware vSphere to OpenShift Virtualization
  # https://access.redhat.com/articles/6242511
  controller_max_vm_inflight: 50
  # Controls the interval at which a new snapshot is requested prior to initiating a warm migration. The default value is 60 minutes.
  # Precopy interval in minutes (default: 60)
  controller_precopy_interval: 60
  # Enable OCP live migration (default: false)
  #
  # Live migration is when a powered on VM is migrated to a separate host or new location within the same host without
  # being shut down. Live migration is available for migrating Virtual Machines within namespaces on the same
  # OpenShift Virtualization provider or between OpenShift Virtualization providers, provided that the source and destination
  # clusters are compatible, and the feature is enabled on both clusters.
  #
  # See also:
  # https://github.com/kubev2v/forklift/blob/8cab1f558b89346d1eefaa2d8947404d884f8dd3/docs/ocp-live-migration.md
  # https://github.com/kubev2v/forklift/blob/8cab1f558b89346d1eefaa2d8947404d884f8dd3/docs/enhancements/kubevirt-live-migration.md
  feature_ocp_live_migration: 'true'
  # Enable copy offload plugins (default: false)
  #
  # See also:
  # https://github.com/kubev2v/forklift/blob/8cab1f558b89346d1eefaa2d8947404d884f8dd3/docs/enhancements/vsphere-xcopy-volume-populator.md
  feature_copy_offload: 'true'
