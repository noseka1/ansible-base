- set_fact:
    mcehostedcluster_info: '{{ mcehostedcluster_kubevirt }}'

# Detach the cluster from MCE before deleting the cluster
- import_role:
    name: openshift_common
    tasks_from: delete_kubernetes_objects.yml
  vars:
    delete_kubernetes_objects:
      - api_version: cluster.open-cluster-management.io/v1
        kind: ManagedCluster
        name: '{{ mcehostedcluster_info.cluster_name }}'

- import_role:
    name: openshift_autogitops
    tasks_from: app_delete.yml
  vars:
    autogitops_app_dst_path: hosted-cluster/{{ mcehostedcluster_info.cluster_name }}-instance

- import_tasks: common/namespace_delete.yml
