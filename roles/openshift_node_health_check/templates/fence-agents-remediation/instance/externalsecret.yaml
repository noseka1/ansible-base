{% for key, value in fenceagents_remediation_node_parameters.items() %}
---
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: remediation-node-{{ key }}
  namespace: openshift-workload-availability
spec:
  secretStoreRef:
    name: autogitops
    kind: ClusterSecretStore
  dataFrom:
  - extract:
      conversionStrategy: Default
      decodingStrategy: None
      metadataPolicy: None
      key: '{{ oscommon_cluster_domain }}/fence-agents-remediation/node/{{ key }}'
{% endfor %}
{% if fenceagents_remediation_shared_parameters.keys() | length > 0 %}
---
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: remediation-shared
  namespace: openshift-workload-availability
spec:
  secretStoreRef:
    name: autogitops
    kind: ClusterSecretStore
  dataFrom:
  - extract:
      conversionStrategy: Default
      decodingStrategy: None
      metadataPolicy: None
      key: '{{ oscommon_cluster_domain }}/fence-agents-remediation/shared'
{% endif %}
